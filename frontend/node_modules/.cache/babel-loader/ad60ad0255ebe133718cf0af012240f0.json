{"remainingRequest":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\projects\\vue-intro\\porsan\\frontend\\src\\store\\auth.js","dependencies":[{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\src\\store\\auth.js","mtime":1574135231000},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiRDovcHJvamVjdHMvdnVlLWludHJvL3BvcnNhbi9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwoKdmFyIF9tdXRhdGlvbnM7CgppbXBvcnQgYXV0aCBmcm9tICcuLi9hcGkvYXV0aCc7CmltcG9ydCBzZXNzaW9uIGZyb20gJy4uL2FwaS9zZXNzaW9uJzsKaW1wb3J0IHsgTE9HSU5fQkVHSU4sIExPR0lOX0ZBSUxVUkUsIExPR0lOX1NVQ0NFU1MsIExPR09VVCwgUkVNT1ZFX1RPS0VOLCBTRVRfVE9LRU4gfSBmcm9tICcuL3R5cGVzJzsKdmFyIFRPS0VOX1NUT1JBR0VfS0VZID0gJ1RPS0VOX1NUT1JBR0VfS0VZJzsKdmFyIGlzUHJvZHVjdGlvbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbic7CnZhciBpbml0aWFsU3RhdGUgPSB7CiAgYXV0aGVudGljYXRpbmc6IGZhbHNlLAogIGVycm9yOiBmYWxzZSwKICB0b2tlbjogbnVsbAp9Owp2YXIgZ2V0dGVycyA9IHsKICBpc0F1dGhlbnRpY2F0ZWQ6IGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZChzdGF0ZSkgewogICAgcmV0dXJuICEhc3RhdGUudG9rZW47CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHZhciB1c2VybmFtZSA9IF9yZWYyLnVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkID0gX3JlZjIucGFzc3dvcmQ7CiAgICBjb21taXQoTE9HSU5fQkVHSU4pOwogICAgcmV0dXJuIGF1dGgubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChfcmVmMykgewogICAgICB2YXIgZGF0YSA9IF9yZWYzLmRhdGE7CiAgICAgIHJldHVybiBjb21taXQoU0VUX1RPS0VOLCBkYXRhLmtleSk7CiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGNvbW1pdChMT0dJTl9TVUNDRVNTKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGNvbW1pdChMT0dJTl9GQUlMVVJFKTsKICAgIH0pOwogIH0sCiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoX3JlZjQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICByZXR1cm4gYXV0aC5sb2dvdXQoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGNvbW1pdChMT0dPVVQpOwogICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBjb21taXQoUkVNT1ZFX1RPS0VOKTsKICAgIH0pOwogIH0sCiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShfcmVmNSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY1LmNvbW1pdDsKICAgIHZhciB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPS0VOX1NUT1JBR0VfS0VZKTsKCiAgICBpZiAoaXNQcm9kdWN0aW9uICYmIHRva2VuKSB7CiAgICAgIGNvbW1pdChSRU1PVkVfVE9LRU4pOwogICAgfQoKICAgIGlmICghaXNQcm9kdWN0aW9uICYmIHRva2VuKSB7CiAgICAgIGNvbW1pdChTRVRfVE9LRU4sIHRva2VuKTsKICAgIH0KICB9Cn07CnZhciBtdXRhdGlvbnMgPSAoX211dGF0aW9ucyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgTE9HSU5fQkVHSU4sIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLmF1dGhlbnRpY2F0aW5nID0gdHJ1ZTsKICBzdGF0ZS5lcnJvciA9IGZhbHNlOwp9KSwgX2RlZmluZVByb3BlcnR5KF9tdXRhdGlvbnMsIExPR0lOX0ZBSUxVUkUsIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLmF1dGhlbnRpY2F0aW5nID0gZmFsc2U7CiAgc3RhdGUuZXJyb3IgPSB0cnVlOwp9KSwgX2RlZmluZVByb3BlcnR5KF9tdXRhdGlvbnMsIExPR0lOX1NVQ0NFU1MsIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLmF1dGhlbnRpY2F0aW5nID0gZmFsc2U7CiAgc3RhdGUuZXJyb3IgPSBmYWxzZTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfbXV0YXRpb25zLCBMT0dPVVQsIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLmF1dGhlbnRpY2F0aW5nID0gZmFsc2U7CiAgc3RhdGUuZXJyb3IgPSBmYWxzZTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfbXV0YXRpb25zLCBTRVRfVE9LRU4sIGZ1bmN0aW9uIChzdGF0ZSwgdG9rZW4pIHsKICBpZiAoIWlzUHJvZHVjdGlvbikgbG9jYWxTdG9yYWdlLnNldEl0ZW0oVE9LRU5fU1RPUkFHRV9LRVksIHRva2VuKTsKICBzZXNzaW9uLmRlZmF1bHRzLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICJUb2tlbiAiLmNvbmNhdCh0b2tlbik7CiAgc3RhdGUudG9rZW4gPSB0b2tlbjsKfSksIF9kZWZpbmVQcm9wZXJ0eShfbXV0YXRpb25zLCBSRU1PVkVfVE9LRU4sIGZ1bmN0aW9uIChzdGF0ZSkgewogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX1NUT1JBR0VfS0VZKTsKICBkZWxldGUgc2Vzc2lvbi5kZWZhdWx0cy5oZWFkZXJzLkF1dGhvcml6YXRpb247CiAgc3RhdGUudG9rZW4gPSBudWxsOwp9KSwgX211dGF0aW9ucyk7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBpbml0aWFsU3RhdGUsCiAgZ2V0dGVyczogZ2V0dGVycywKICBhY3Rpb25zOiBhY3Rpb25zLAogIG11dGF0aW9uczogbXV0YXRpb25zCn07"},{"version":3,"sources":["D:/projects/vue-intro/porsan/frontend/src/store/auth.js"],"names":["auth","session","LOGIN_BEGIN","LOGIN_FAILURE","LOGIN_SUCCESS","LOGOUT","REMOVE_TOKEN","SET_TOKEN","TOKEN_STORAGE_KEY","isProduction","process","env","NODE_ENV","initialState","authenticating","error","token","getters","isAuthenticated","state","actions","login","commit","username","password","then","data","key","catch","logout","finally","initialize","localStorage","getItem","mutations","setItem","defaults","headers","Authorization","removeItem","namespaced"],"mappings":"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","sourcesContent":["import auth from '../api/auth';\nimport session from '../api/session';\nimport {\n  LOGIN_BEGIN,\n  LOGIN_FAILURE,\n  LOGIN_SUCCESS,\n  LOGOUT,\n  REMOVE_TOKEN,\n  SET_TOKEN,\n} from './types';\n\nconst TOKEN_STORAGE_KEY = 'TOKEN_STORAGE_KEY';\nconst isProduction = process.env.NODE_ENV === 'production';\n\nconst initialState = {\n  authenticating: false,\n  error: false,\n  token: null,\n};\n\nconst getters = {\n  isAuthenticated: state => !!state.token,\n};\n\nconst actions = {\n  login({ commit }, { username, password }) {\n    commit(LOGIN_BEGIN);\n    return auth.login(username, password)\n      .then(({ data }) => commit(SET_TOKEN, data.key))\n      .then(() => commit(LOGIN_SUCCESS))\n      .catch(() => commit(LOGIN_FAILURE));\n  },\n  logout({ commit }) {\n    return auth.logout()\n      .then(() => commit(LOGOUT))\n      .finally(() => commit(REMOVE_TOKEN));\n  },\n  initialize({ commit }) {\n    const token = localStorage.getItem(TOKEN_STORAGE_KEY);\n\n    if (isProduction && token) {\n      commit(REMOVE_TOKEN);\n    }\n\n    if (!isProduction && token) {\n      commit(SET_TOKEN, token);\n    }\n  },\n};\n\nconst mutations = {\n  [LOGIN_BEGIN](state) {\n    state.authenticating = true;\n    state.error = false;\n  },\n  [LOGIN_FAILURE](state) {\n    state.authenticating = false;\n    state.error = true;\n  },\n  [LOGIN_SUCCESS](state) {\n    state.authenticating = false;\n    state.error = false;\n  },\n  [LOGOUT](state) {\n    state.authenticating = false;\n    state.error = false;\n  },\n  [SET_TOKEN](state, token) {\n    if (!isProduction) localStorage.setItem(TOKEN_STORAGE_KEY, token);\n    session.defaults.headers.Authorization = `Token ${token}`;\n    state.token = token;\n  },\n  [REMOVE_TOKEN](state) {\n    localStorage.removeItem(TOKEN_STORAGE_KEY);\n    delete session.defaults.headers.Authorization;\n    state.token = null;\n  },\n};\n\nexport default {\n  namespaced: true,\n  state: initialState,\n  getters,\n  actions,\n  mutations,\n};\n"]}]}