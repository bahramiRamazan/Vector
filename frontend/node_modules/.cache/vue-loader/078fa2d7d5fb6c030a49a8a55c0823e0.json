{"remainingRequest":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\projects\\vue-intro\\porsan\\frontend\\src\\views\\Question.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\src\\views\\Question.vue","mtime":1608885168913},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projects\\vue-intro\\porsan\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFwaVNlcnZpY2UgfSBmcm9tICJAL2NvbW1vbi9hcGkuc2VydmljZS5qcyI7CmltcG9ydCBBbnN3ZXJDb21wb25lbnQgZnJvbSAiQC9jb21wb25lbnRzL0Fuc3dlci52dWUiOwppbXBvcnQgUXVlc3Rpb25BY3Rpb25zIGZyb20gIkAvY29tcG9uZW50cy9RdWVzdGlvbkFjdGlvbnMudnVlIjsKaW1wb3J0IEJhc2VMYXlvdXQgZnJvbSAiQC9jb21wb25lbnRzL0Jhc2VMYXlvdXQudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIAogIG5hbWU6ICJRdWVzdGlvbiIsCiAgcHJvcHM6IHsKICAgIHNsdWc6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgQW5zd2VyQ29tcG9uZW50LAogICAgUXVlc3Rpb25BY3Rpb25zLAogICAgICBCYXNlTGF5b3V0CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcXVlc3Rpb246IHt9LAogICAgICBhbnN3ZXJzOiBbXSwKICAgICAgbmV4dDogbnVsbCwKICAgICAgbG9hZGluZ0Fuc3dlcnM6IGZhbHNlLAogICAgICBuZXdBbnN3ZXJCb2R5OiBudWxsLAogICAgICBlcnJvcjogbnVsbCwKICAgICAgdXNlckhhc0Fuc3dlcmVkOiBmYWxzZSwKICAgICAgc2hvd0Zvcm06IGZhbHNlLAogICAgICByZXF1ZXN0VXNlcjogbnVsbAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzUXVlc3Rpb25BdXRob3IoKSB7CiAgICAgIC8vIHJldHVybiB0cnVlIGlmIHRoZSBsb2dnZWQgaW4gdXNlciBpcyBhbHNvIHRoZSBhdXRob3Igb2YgdGhlIHF1ZXN0aW9uIGluc3RhbmNlCiAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uLmF1dGhvciA9PT0gdGhpcy5yZXF1ZXN0VXNlcjsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHNldFBhZ2VUaXRsZSh0aXRsZSkgewogICAgICAvLyBzZXQgYSBnaXZlbiB0aXRsZSBzdHJpbmcgYXMgdGhlIHdlYnBhZ2UgdGl0bGUKICAgICAgZG9jdW1lbnQudGl0bGUgPSB0aXRsZTsKICAgIH0sCiAgICBzZXRSZXF1ZXN0VXNlcigpIHsKICAgICAgLy8gdGhlIHVzZXJuYW1lIGhhcyBiZWVuIHNldCB0byBsb2NhbFN0b3JhZ2UgYnkgdGhlIEFwcC52dWUgY29tcG9uZW50CiAgICAgIHRoaXMucmVxdWVzdFVzZXIgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJuYW1lIik7CiAgICB9LAogICAgZ2V0UXVlc3Rpb25EYXRhKCkgewogICAgICAvLyBnZXQgdGhlIGRldGFpbHMgb2YgYSBxdWVzdGlvbiBpbnN0YW5jZSBmcm9tIHRoZSBSRVNUIEFQSSBhbmQgY2FsbCBzZXRQYWdlVGl0bGUKICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcXVlc3Rpb25zLyR7dGhpcy5zbHVnfS9gOwogICAgICBhcGlTZXJ2aWNlKGVuZHBvaW50KQogICAgICAgIC50aGVuKGRhdGEgPT4gewogICAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgICAgdGhpcy5xdWVzdGlvbiA9IGRhdGE7CiAgICAgICAgICAgIC8vIHRoaXMudXNlckhhc0Fuc3dlcmVkID0gZGF0YS51c2VyX2hhc19hbnN3ZXJlZDsKICAgICAgICAgICAgdGhpcy5zZXRQYWdlVGl0bGUoZGF0YS5jb250ZW50KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5xdWVzdGlvbiA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuc2V0UGFnZVRpdGxlKCI0MDQgLSBQYWdlIE5vdCBGb3VuZCIpCiAgICAgICAgICB9CgogICAgICAgIH0pCiAgICB9LAogICAgZ2V0UXVlc3Rpb25BbnN3ZXJzKCkgewogICAgICAvLyBnZXQgYSBwYWdlIG9mIGFuc3dlcnMgZm9yIGEgc2luZ2xlIHF1ZXN0aW9uIGZyb20gdGhlIFJFU1QgQVBJJ3MgcGFnaW5hdGVkICdRdWVzdGlvbnMgRW5kcG9pbnQnCiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL3F1ZXN0aW9ucy8ke3RoaXMuc2x1Z30vYW5zd2Vycy9gOwoKICAgIAogICAgICBpZiAodGhpcy5uZXh0KSB7CiAgICAgICAgZW5kcG9pbnQgPSB0aGlzLm5leHQ7CiAgICAgIH0KICAgICAgdGhpcy5sb2FkaW5nQW5zd2VycyA9IHRydWU7CiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQpCiAgICAgICAgLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICB0aGlzLmFuc3dlcnMucHVzaCguLi5kYXRhLnJlc3VsdHMpOwogICAgICAgICAgdGhpcy5sb2FkaW5nQW5zd2VycyA9IGZhbHNlOwogICAgICAgICAgaWYgKGRhdGEubmV4dCkgewogICAgICAgICAgICB0aGlzLm5leHQgPSBkYXRhLm5leHQ7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLm5leHQgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICB9LAogICAgb25TdWJtaXQoKSB7CiAgICAgIC8vIFRlbGwgdGhlIFJFU1QgQVBJIHRvIGNyZWF0ZSBhIG5ldyBhbnN3ZXIgZm9yIHRoaXMgcXVlc3Rpb24gYmFzZWQgb24gdGhlIHVzZXIgaW5wdXQsIHRoZW4gdXBkYXRlIHNvbWUgZGF0YSBwcm9wZXJ0aWVzCiAgICAgIGlmICh0aGlzLm5ld0Fuc3dlckJvZHkpIHsKICAgICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9xdWVzdGlvbnMvJHt0aGlzLnNsdWd9L2Fuc3dlci9gOwogICAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJQT1NUIiwgeyBib2R5OiB0aGlzLm5ld0Fuc3dlckJvZHkgfSkKICAgICAgICAgIC50aGVuKGRhdGEgPT4gewogICAgICAgICAgICB0aGlzLmFuc3dlcnMudW5zaGlmdChkYXRhKQogICAgICAgICAgfSkKICAgICAgICB0aGlzLm5ld0Fuc3dlckJvZHkgPSBudWxsOwogICAgICAgIHRoaXMuc2hvd0Zvcm0gPSBmYWxzZTsKICAgICAgICB0aGlzLnVzZXJIYXNBbnN3ZXJlZCA9IHRydWU7CiAgICAgICAgaWYgKHRoaXMuZXJyb3IpIHsKICAgICAgICAgIHRoaXMuZXJyb3IgPSBudWxsOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmVycm9yID0gIllvdSBjYW4ndCBzZW5kIGFuIGVtcHR5IGFuc3dlciEiOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgZGVsZXRlQW5zd2VyKGFuc3dlcikgewogICAgICAvLyBkZWxldGUgYSBnaXZlbiBhbnN3ZXIgZnJvbSB0aGUgYW5zd2VycyBhcnJheSBhbmQgbWFrZSBhIGRlbGV0ZSByZXF1ZXN0IHRvIHRoZSBSRVNUIEFQSQogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9hbnN3ZXJzLyR7YW5zd2VyLmlkfS9gOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGFwaVNlcnZpY2UoZW5kcG9pbnQsICJERUxFVEUiKQogICAgICAgIHRoaXMuJGRlbGV0ZSh0aGlzLmFuc3dlcnMsIHRoaXMuYW5zd2Vycy5pbmRleE9mKGFuc3dlcikpCiAgICAgICAgdGhpcy51c2VySGFzQW5zd2VyZWQgPSBmYWxzZTsKICAgICAgfQogICAgICBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRRdWVzdGlvbkRhdGEoKQogICAgdGhpcy5nZXRRdWVzdGlvbkFuc3dlcnMoKQogICAgdGhpcy5zZXRSZXF1ZXN0VXNlcigpCiAgfQp9Cg=="},{"version":3,"sources":["Question.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Question.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"page\">\n    <div bmt-12>\n    </div>\n\n    <BaseLayout>\n      <template v-slot:right>\n            <b-card bg-variant=\"light\">\n  <div class=\"single-question mt-2\">\n    <div v-if=\"question\" class=\"container\">\n      <h1>{{ question.content }}</h1>\n      <QuestionActions\n        v-if=\"isQuestionAuthor\"\n        :slug=\"question.slug\"\n      />\n      <p class=\"mb-0\">Posted by:\n        <span class=\"author-name\">{{ question.author }}</span>\n      </p>\n      <p>{{ question.created_at }}</p>\n      <hr>\n      <div v-if=\"userHasAnswered\">\n        <p class=\"answer-added\">You've written an answer!</p>\n      </div>\n      <div v-else-if=\"showForm\">\n        <form class=\"card\" @submit.prevent=\"onSubmit\">\n          <div class=\"card-header px-3\">\n            Answer the Question\n          </div>\n          <div class=\"card-block\">\n            <textarea \n              v-model=\"newAnswerBody\"\n              class=\"form-control\"\n              placeholder=\"Share Your Knowledge!\"\n              rows=\"5\"\n            ></textarea>\n          </div>\n          <div class=\"card-footer px-3\">\n            <button type=\"submit\" class=\"btn btn-sm btn-success\">Submit Your Answer</button>\n          </div>\n        </form>\n        <p v-if=\"error\" class=\"error mt-2\">{{ error }}</p>\n      </div>\n      <div v-else>\n        <button\n          class=\"btn btn-sm btn-success\"\n          @click=\"showForm = true\"\n          >Answer the Question\n        </button>\n      </div>\n      <hr>\n    </div>\n    <div v-else>\n      <h1 class=\"error text-center\">404 - Question Not Found</h1>\n    </div>\n    <div v-if=\"question\" class=\"container\">\n      <AnswerComponent \n        v-for=\"answer in answers\"\n        :answer=\"answer\"\n        :requestUser=\"requestUser\"\n        :key=\"answer.id\"\n        @delete-answer=\"deleteAnswer\"\n      />\n      <div class=\"my-4\">\n        <p v-show=\"loadingAnswers\">...loading...</p>\n        <button\n          v-show=\"next\"\n          @click=\"getQuestionAnswers\"\n          class=\"btn btn-sm btn-outline-success\"\n          >Load More\n        </button>\n      </div>\n    </div>\n  </div>\n    </b-card>\n      </template>\n    </BaseLayout>\n  </div>\n</template>\n\n<script>\nimport { apiService } from \"@/common/api.service.js\";\nimport AnswerComponent from \"@/components/Answer.vue\";\nimport QuestionActions from \"@/components/QuestionActions.vue\";\nimport BaseLayout from \"@/components/BaseLayout.vue\";\nexport default {\n  \n  name: \"Question\",\n  props: {\n    slug: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    AnswerComponent,\n    QuestionActions,\n      BaseLayout\n  },\n  data() {\n    return {\n      question: {},\n      answers: [],\n      next: null,\n      loadingAnswers: false,\n      newAnswerBody: null,\n      error: null,\n      userHasAnswered: false,\n      showForm: false,\n      requestUser: null\n    }\n  },\n  computed: {\n    isQuestionAuthor() {\n      // return true if the logged in user is also the author of the question instance\n      return this.question.author === this.requestUser;\n    }\n  },\n  methods: {\n    setPageTitle(title) {\n      // set a given title string as the webpage title\n      document.title = title;\n    },\n    setRequestUser() {\n      // the username has been set to localStorage by the App.vue component\n      this.requestUser = window.localStorage.getItem(\"username\");\n    },\n    getQuestionData() {\n      // get the details of a question instance from the REST API and call setPageTitle\n      let endpoint = `/api/questions/${this.slug}/`;\n      apiService(endpoint)\n        .then(data => {\n          if (data) {\n            this.question = data;\n            // this.userHasAnswered = data.user_has_answered;\n            this.setPageTitle(data.content)\n          } else {\n            this.question = null;\n            this.setPageTitle(\"404 - Page Not Found\")\n          }\n\n        })\n    },\n    getQuestionAnswers() {\n      // get a page of answers for a single question from the REST API's paginated 'Questions Endpoint'\n      let endpoint = `/api/questions/${this.slug}/answers/`;\n\n    \n      if (this.next) {\n        endpoint = this.next;\n      }\n      this.loadingAnswers = true;\n      apiService(endpoint)\n        .then(data => {\n          this.answers.push(...data.results);\n          this.loadingAnswers = false;\n          if (data.next) {\n            this.next = data.next;\n          } else {\n            this.next = null;\n          }\n        })\n    },\n    onSubmit() {\n      // Tell the REST API to create a new answer for this question based on the user input, then update some data properties\n      if (this.newAnswerBody) {\n        let endpoint = `/api/questions/${this.slug}/answer/`;\n        apiService(endpoint, \"POST\", { body: this.newAnswerBody })\n          .then(data => {\n            this.answers.unshift(data)\n          })\n        this.newAnswerBody = null;\n        this.showForm = false;\n        this.userHasAnswered = true;\n        if (this.error) {\n          this.error = null;\n        }\n      } else {\n        this.error = \"You can't send an empty answer!\";\n      }\n    },\n    async deleteAnswer(answer) {\n      // delete a given answer from the answers array and make a delete request to the REST API\n      let endpoint = `/api/answers/${answer.id}/`;\n      try {\n        await apiService(endpoint, \"DELETE\")\n        this.$delete(this.answers, this.answers.indexOf(answer))\n        this.userHasAnswered = false;\n      }\n      catch (err) {\n        console.log(err)\n      }\n    }\n  },\n  created() {\n    this.getQuestionData()\n    this.getQuestionAnswers()\n    this.setRequestUser()\n  }\n}\n</script>\n\n<style scoped>\n.author-name {\n  font-weight: bold;\n  color: #DC3545;\n}\n\n.answer-added {\n  font-weight: bold;\n  color: green;\n}\n\n.error {\n  font-weight: bold;\n  color: red; \n}\n</style>\n"]}]}